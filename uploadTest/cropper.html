<html>
  <head>
    <link rel="stylesheet" href="./css/croppie.css" />
  </head>

  <body>
    <div class="demo-wrap upload-demo">
        <div class="container">
        <div class="grid">
            <div class="col-1-2">
                <div class="actions">
                    <a class="btn file-btn">
                        <span>Upload</span>
                        <input type="file" id="upload" value="Choose a file" accept="image/*" />
                    </a>
                    <button class="upload-result">Result</button>
                </div>
            </div>
            <div class="col-1-2">
                <div class="upload-msg">
                    Upload a file to start cropping
                </div>
                <div class="upload-demo-wrap">
                    <div id="upload-demo"></div>
                </div>
            </div>
        </div>
    </div>
    <script src="js/jquery.js"></script>
    <script src="./js/croppie.js"></script>
    <script>
        var $uploadCrop;

        function readFile(input) {
          if (input.files && input.files[0]) {
            var reader = new FileReader();

            reader.onload = function(e) {
              $(".upload-demo").addClass("ready");
              $uploadCrop
                .croppie("bind", {
                  url: e.target.result
                })
                .then(function() {
                  console.log("jQuery bind complete");
                });
            };

            reader.readAsDataURL(input.files[0]);
          } else {
            swal("Sorry - you're browser doesn't support the FileReader API");
          }
        }

        $uploadCrop = $("#upload-demo").croppie({
          viewport: {
            width: 300,
            height: 300,
          },
          boundary: {
              width: 400,
              height: 400,
          },
          enableExif: true
        });

        $("#upload").on("change", function() {
          readFile(this);
        });
        $(".upload-result").on("click", function(ev) {
          $uploadCrop
            .croppie("result", {
              type: "canvas",
              size: "viewport"
            })
            .then(function(resp) {
              popupResult({
                src: resp
              });
            });
        });
    </script>
  </body>
</html>
